<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org" lang="es">
<head th:replace="~{fragments/base :: head(styles='/css/lista-styles.css')}"></head>
<body>
<header th:replace="~{fragments/base :: headerCompleto}"></header>
  <h1>Lista de Clientes</h1>

  <div class="container mb-5">
    <div class="table-responsive">
      <table class="table table-striped table-hover align-middle">
        <thead class="table-dark">
          <tr>
            <th>ID</th>
            <th>Nombre</th>
            <th>Apellidos</th>
            <th>Email</th>
            <th>Teléfono</th>
            <th>Crédito</th>
            <th>Foto</th>
            <th>Destacado</th>
            <th>Cuenta de Usuario</th>
            <th>Acciones</th>
          </tr>
        </thead>

        <tbody>
          
          <tr th:each="cliente : ${clienteLista}">
            <td th:text="${cliente.id}"></td>
            <td th:text="${cliente.nombre}"></td>
            <td th:text="${cliente.apellidos}"></td>
            <td th:text="${cliente.email}"></td>
            <td th:text="${cliente.telefono}"></td>
            <td th:text="${cliente.credito}"></td>
            <td>
			    <img th:if="${cliente.fotocliente != null}" 
			         th:src="${cliente.fotocliente}" 
			         width="100" height="100" alt="Foto del Cliente">
			         
			    <img th:unless="${cliente.fotocliente != null}" 
			         th:src="@{/imagen/clientes/default.png}" 
			         width="100" height="100" alt="Sin Foto">
			</td>
            <td th:text="${cliente.destacado} == 1 ? 'Sí' : 'No'"></td>
            <td>
		      <div th:if="${cliente.usuario != null}">
		        <span class="badge bg-dark">
		          <i class="bi bi-person-check-fill"></i>
		          <span th:text="${cliente.usuario.username}"></span>
		        </span>
		      </div>
		      
		      <div th:if="${cliente.usuario == null}">
		        <a th:href="@{/usuarios/asignar/{id}(id=${cliente.id})}" 
		           class="btn btn-sm btn-success">
		          <i class="bi bi-person-plus-fill"></i> Asignar Login
		        </a>
		      </div>
		    </td>
            <td>
			  <a th:href="@{/ver/{id}(id=${cliente.id})}" class="btn btn-sm btn-primary">Detalles</a>
			  
			  <a th:href="@{/modificar/{id}(id=${cliente.id})}" class="btn btn-sm btn-warning" >Modificar</a>
			  
			  <a th:href="@{/eliminar/{id}(id=${cliente.id})}"
			     class="btn btn-sm btn-danger"
			     onclick="return confirm('¿Estás seguro de que deseas eliminar este cliente?');" >Eliminar</a>
			</td>
          </tr>
        </tbody>
      </table>
    </div>
  </div>

  <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js"></script>
<footer th:replace="~{fragments/base :: footer}"></footer>
</body>
</html>
